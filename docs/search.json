[
  {
    "objectID": "notebooks/user_guide_template.html",
    "href": "notebooks/user_guide_template.html",
    "title": "Data User Guide Template",
    "section": "",
    "text": "TOPST SCHOOL project: https://ciesin-geospatial.github.io/TOPSTSCHOOL-SPHINX/\n\nSpecific lesson: NRT Water Lesson: https://ciesin-geospatial.github.io/TOPSTSCHOOL-water/m102-lance-modis-nrt-global-flood.html\n\nPytidycensus examples page: https://github.com/mmann1123/pytidycensus/tree/main/examples\nNASA Earthdata Cloud Cookbook: https://nasa-openscapes.github.io/earthdata-cloud-cookbook/tutorials/\nGSAPP Smorgasbord: https://cdp.arch.columbia.edu/smorgasbord/modules/5-computational-design-modeling-in-grasshopper/5-7_Design-Space/\n\n\n\n\n\nProvide links to any relevant URLs including code packages, data documentation\nProvide links to other help/guides when relevant instead of DIY. For example, link to a guide on accessing REST APIs instead of writing a whole section yourself. Two options for this:\n\nhttps://zapier.com/blog/how-to-use-api/#what\nhttps://guides.dataverse.org/en/6.8/api/getting-started.html\n\nUse open source tools whenever possible to facilitate user accessibility. Where an open tool is not available, explain why the tool is necessary and point to some possible alternatives\n\n\n\n\n\n\n\n\nBrief, plain-language description of the dataset\n\nLinks to our datahub, API\n\nTime period covered\n\nGeographic or population coverage\n\nLicense (e.g., CC BY 4.0)\nCitation guidance\nAny usage restrictions\n\n\n\n\n\nIntended audience\nSuggested skill level (beginner / intermediate / advanced)\n\n\n\n\n\n\nList 5‚Äì6 example questions users can explore, in addition to the key question that we will be exploring in this guide.\n\nHow has X changed over time?\nAre there differences in X by region or demographic group?\nWhich areas experience the highest or lowest values?\n\nExplain why this data set is appropriate to use to assess the key question.\n\n\n\n\n\n\n\nLink(s) to download location (portal, GitHub, API, cloud storage)\nFile formats available (CSV, Excel, Parquet, API endpoint)\n\n\n\n\nStep-by-step instructions: 1. Navigate to ‚Ä¶ 2. Click ‚Ä¶ 3. Select format ‚Ä¶\n\nInclude screenshots if possible.\n\n\n\n\n\n\n\n\n\n\n\nFile Name\nDescription\n\n\n\n\ndata.csv\nMain cleaned dataset\n\n\ncodebook.csv\nVariable definitions\n\n\nmetadata.json\nCollection and methodology details\n\n\n\n\n\n\nClearly state what one row represents:\n\nOne road\n\nOne ward\n\nOne health facility\nEtc\n\n\n\n\n\n\n\n\nHighlight the most important fields.\n\n\n\nVariable\nDescription\nType\nExample\n\n\n\n\ncounty\nCounty name\nCategorical\nCook\n\n\nyear\nCalendar year\nInteger\n2022\n\n\nfunding_usd\nTotal funding\nNumeric\n125000\n\n\n\n\n\n\n\nHow missing values are represented (e.g., NA, blank, -999)\nKnown gaps or limitations\n\n\n\n\n\n\n\nKnown sources of bias\nData collection limitations\nChanges in methodology over time\nWhat the data should not be used for\n\n\n\n\n\n\n\n\nR (which packages?)\nPython (which packages?)\nArcGIS Pro / QGIS\nExcel / Google Sheets\nLocal computing requirements (if any) - provide alternatives to local processing\n\nJupyterLab/CoLab\n\n\n\n\n\n\n\n\n\nSubset to year or area of interest\n\n\n\n\n\nCalculate summary statistics",
    "crumbs": [
      "Home",
      "Data Access",
      "Data User Guide Template"
    ]
  },
  {
    "objectID": "notebooks/user_guide_template.html#examples",
    "href": "notebooks/user_guide_template.html#examples",
    "title": "Data User Guide Template",
    "section": "",
    "text": "TOPST SCHOOL project: https://ciesin-geospatial.github.io/TOPSTSCHOOL-SPHINX/\n\nSpecific lesson: NRT Water Lesson: https://ciesin-geospatial.github.io/TOPSTSCHOOL-water/m102-lance-modis-nrt-global-flood.html\n\nPytidycensus examples page: https://github.com/mmann1123/pytidycensus/tree/main/examples\nNASA Earthdata Cloud Cookbook: https://nasa-openscapes.github.io/earthdata-cloud-cookbook/tutorials/\nGSAPP Smorgasbord: https://cdp.arch.columbia.edu/smorgasbord/modules/5-computational-design-modeling-in-grasshopper/5-7_Design-Space/",
    "crumbs": [
      "Home",
      "Data Access",
      "Data User Guide Template"
    ]
  },
  {
    "objectID": "notebooks/user_guide_template.html#tips-and-pointers",
    "href": "notebooks/user_guide_template.html#tips-and-pointers",
    "title": "Data User Guide Template",
    "section": "",
    "text": "Provide links to any relevant URLs including code packages, data documentation\nProvide links to other help/guides when relevant instead of DIY. For example, link to a guide on accessing REST APIs instead of writing a whole section yourself. Two options for this:\n\nhttps://zapier.com/blog/how-to-use-api/#what\nhttps://guides.dataverse.org/en/6.8/api/getting-started.html\n\nUse open source tools whenever possible to facilitate user accessibility. Where an open tool is not available, explain why the tool is necessary and point to some possible alternatives",
    "crumbs": [
      "Home",
      "Data Access",
      "Data User Guide Template"
    ]
  },
  {
    "objectID": "notebooks/user_guide_template.html#overview",
    "href": "notebooks/user_guide_template.html#overview",
    "title": "Data User Guide Template",
    "section": "",
    "text": "Brief, plain-language description of the dataset\n\nLinks to our datahub, API\n\nTime period covered\n\nGeographic or population coverage\n\nLicense (e.g., CC BY 4.0)\nCitation guidance\nAny usage restrictions\n\n\n\n\n\nIntended audience\nSuggested skill level (beginner / intermediate / advanced)",
    "crumbs": [
      "Home",
      "Data Access",
      "Data User Guide Template"
    ]
  },
  {
    "objectID": "notebooks/user_guide_template.html#key-questions-this-data-can-answer",
    "href": "notebooks/user_guide_template.html#key-questions-this-data-can-answer",
    "title": "Data User Guide Template",
    "section": "",
    "text": "List 5‚Äì6 example questions users can explore, in addition to the key question that we will be exploring in this guide.\n\nHow has X changed over time?\nAre there differences in X by region or demographic group?\nWhich areas experience the highest or lowest values?\n\nExplain why this data set is appropriate to use to assess the key question.",
    "crumbs": [
      "Home",
      "Data Access",
      "Data User Guide Template"
    ]
  },
  {
    "objectID": "notebooks/user_guide_template.html#data-access",
    "href": "notebooks/user_guide_template.html#data-access",
    "title": "Data User Guide Template",
    "section": "",
    "text": "Link(s) to download location (portal, GitHub, API, cloud storage)\nFile formats available (CSV, Excel, Parquet, API endpoint)\n\n\n\n\nStep-by-step instructions: 1. Navigate to ‚Ä¶ 2. Click ‚Ä¶ 3. Select format ‚Ä¶\n\nInclude screenshots if possible.",
    "crumbs": [
      "Home",
      "Data Access",
      "Data User Guide Template"
    ]
  },
  {
    "objectID": "notebooks/user_guide_template.html#dataset-structure",
    "href": "notebooks/user_guide_template.html#dataset-structure",
    "title": "Data User Guide Template",
    "section": "",
    "text": "File Name\nDescription\n\n\n\n\ndata.csv\nMain cleaned dataset\n\n\ncodebook.csv\nVariable definitions\n\n\nmetadata.json\nCollection and methodology details\n\n\n\n\n\n\nClearly state what one row represents:\n\nOne road\n\nOne ward\n\nOne health facility\nEtc",
    "crumbs": [
      "Home",
      "Data Access",
      "Data User Guide Template"
    ]
  },
  {
    "objectID": "notebooks/user_guide_template.html#variables-definitions",
    "href": "notebooks/user_guide_template.html#variables-definitions",
    "title": "Data User Guide Template",
    "section": "",
    "text": "Highlight the most important fields.\n\n\n\nVariable\nDescription\nType\nExample\n\n\n\n\ncounty\nCounty name\nCategorical\nCook\n\n\nyear\nCalendar year\nInteger\n2022\n\n\nfunding_usd\nTotal funding\nNumeric\n125000\n\n\n\n\n\n\n\nHow missing values are represented (e.g., NA, blank, -999)\nKnown gaps or limitations",
    "crumbs": [
      "Home",
      "Data Access",
      "Data User Guide Template"
    ]
  },
  {
    "objectID": "notebooks/user_guide_template.html#data-quality-limitations",
    "href": "notebooks/user_guide_template.html#data-quality-limitations",
    "title": "Data User Guide Template",
    "section": "",
    "text": "Known sources of bias\nData collection limitations\nChanges in methodology over time\nWhat the data should not be used for",
    "crumbs": [
      "Home",
      "Data Access",
      "Data User Guide Template"
    ]
  },
  {
    "objectID": "notebooks/user_guide_template.html#getting-started-quick-setup",
    "href": "notebooks/user_guide_template.html#getting-started-quick-setup",
    "title": "Data User Guide Template",
    "section": "",
    "text": "R (which packages?)\nPython (which packages?)\nArcGIS Pro / QGIS\nExcel / Google Sheets\nLocal computing requirements (if any) - provide alternatives to local processing\n\nJupyterLab/CoLab\n\n\n\n\n\n\n\n\n\nSubset to year or area of interest\n\n\n\n\n\nCalculate summary statistics",
    "crumbs": [
      "Home",
      "Data Access",
      "Data User Guide Template"
    ]
  },
  {
    "objectID": "notebooks/api_nga_network.html",
    "href": "notebooks/api_nga_network.html",
    "title": "Finding routes between schools and health facilities",
    "section": "",
    "text": "The CIESIN GRID3 data provides high-resolution geospatial data that can be used to analyze various aspects of infrastructure and services in Nigeria. One practical application of this data is to find optimal routes between schools and health facilities. Below is an example of how to achieve this using Python and relevant libraries.\n\n# install neccessary packages\n!pip install osmnx\n!pip install mapclassify\n!pip install folium\n!pip install momepy\n\n\n# import\nimport geopandas as gpd\nimport networkx as nx\nimport momepy\nimport osmnx as ox\nimport matplotlib.pyplot as plt\nfrom itertools import product\nimport numpy as np\nimport mapclassify\nimport folium\nimport json\nimport pandas as pd\nimport momepy \nimport requests \n\n\n# install arcgis API for accessing data\n# check that arcgis is installed \n!pip install arcgis\n    \n\n\n# import arcgis\nfrom arcgis.gis import GIS \n\n\n# Anonymously authenticate arcgis API\ngis = GIS()\n\n\ndef fetch_nga_roads(bbox, crs, record_limit, url):\n    \"\"\"\n    Fetch NGA roads from an ArcGIS FeatureServer within a bounding box.\n\n    Parameters\n    ----------\n    bbox : dict\n        Bounding box with keys xmin, ymin, xmax, ymax (in EPSG:3857).\n    crs : str, optional\n        CRS for the output GeoDataFrame (default: EPSG:3857).\n    record_limit : int, optional\n        Maximum number of records per request (default: 200000).\n    url : str, optional\n        ArcGIS FeatureServer query URL.\n\n    Returns\n    -------\n    geopandas.GeoDataFrame\n        GeoDataFrame containing all fetched road features.\n    \"\"\"\n\n    params = {\n        \"f\": \"geojson\",\n        \"where\": \"1=1\",\n        \"geometry\": json.dumps({\n            **bbox,\n            \"spatialReference\": {\"wkid\": int(crs.split(\":\")[1])},\n        }),\n        \"geometryType\": \"esriGeometryEnvelope\",\n        \"spatialRel\": \"esriSpatialRelContains\",\n        \"outFields\": \"*\",\n        \"returnGeometry\": \"true\",\n        \"resultRecordCount\": record_limit,\n    }\n\n    all_features = []\n    offset = 0\n\n    while True:\n        paged_params = params | {\"resultOffset\": offset}\n        r = requests.get(url, params=paged_params)\n        r.raise_for_status()\n\n        data = r.json()\n        features = data.get(\"features\", [])\n\n        if not features:\n            break\n\n        all_features.extend(features)\n        offset += len(features)\n        \n    valid_features = [\n        f for f in all_features\n        if f.get(\"geometry\") is not None]\n\n    return gpd.GeoDataFrame.from_features(valid_features, crs=crs)\n\n\n# Read in service for NGA roads\nurl = \"https://services3.arcgis.com/BU6Aadhn6tbBEdyk/arcgis/rest/services/GRID3_NGA_roads/FeatureServer/0/query\"\n\nboundbox =  {\n        \"xmin\": 360102.4944,\n        \"ymin\": 725614.4996,\n        \"xmax\": 381199.1042,\n        \"ymax\": 746837.3928  }\n\n\n\ngdf = fetch_nga_roads(boundbox, crs=\"EPSG:3857\", record_limit=1000, url=url)\n\ngdf \n\n\n# Plot roads\ngdf.plot()\n\n\nexploded_road_gdf = gdf.copy()\n\nexploded_road_gdf = exploded_road_gdf.set_crs(epsg=4326, allow_override=True)\n    \nexploded_road_gdf = exploded_road_gdf.to_crs('EPSG:3857')\n\nexploded_road_gdf = exploded_road_gdf.explode(index_parts=True) \n\n\nexploded_road_gdf['length_meters'] = exploded_road_gdf.geometry.length \n\n# Build network\nGs = momepy.gdf_to_nx(\n    exploded_road_gdf,\n    directed='MultiDiGraph',           \n    approach='primal',\n    integer_labels=True,\n    preserve_index=True,\n    length='length_meters'        \n)\n\n\n# üîß OSMnx compatibility: alias length_meters ‚Üí length\nfor _, _, data in Gs.edges(data=True):\n    data[\"length\"] = data[\"length_meters\"] \n\n\n\n\n# # Back to GeoDataFrames\nnodes, edges = momepy.nx_to_gdf(Gs, points=True, lines=True)\n \n\n# # Try roundabout simplification\nedges = momepy.roundabout_simplification(edges)\n \n \nedges\n\n\n\n# check simplification group\nedges['simplification_group'].value_counts()\n\n\n# Plot nodes and edges\nax = edges.plot(figsize=(10,10), color=\"gray\", lw=1.0)\nax = nodes.plot(ax=ax, color=\"green\", markersize=4)\n\n\n# Calculate time to traverse a road segment in minutes using the speed estimate and length\nedges[\"travel_time_mins\"] = ((edges[\"length_meters\"]/1000) / (edges[\"speed_estimate\"])) * 60\n\n# drop if travel_time_mins is infinite or NaN or less than equal to zero\nedges = edges.replace([np.inf, -np.inf], np.nan)\nedges = edges.dropna(subset=['travel_time_mins'])\nedges = edges[edges['travel_time_mins'] &gt; 0]    \n\nedges.head()\n\n\nfig, (ax1, ax2) = plt.subplots(ncols=2, figsize=(10, 5))\n\n# Plot speed estimate\nax1 = edges.plot(column=\"speed_estimate\", legend=True,ax=ax1, cmap='viridis')\nax1.set_title('Speed (Km/h)')\n\n# Plot travel time\nax2 = edges.plot(column=\"travel_time_mins\", legend=True,ax=ax2, cmap='inferno',scheme='natural_breaks')\nax2.set_title('Travel Time (Minutes)')\n\nplt.tight_layout()\nplt.show()\n\n\nfrom pyproj import Transformer\n\n# Geocode an origin and destination address\n# Origin\norig_address = \"Oshitelu St, Lagos, Nigeria\"\n\norig_y, orig_x = ox.geocode(orig_address)  # notice the coordinate order (y, x)!\n\n# Destination\ndest_address = \"Obafemi Awolowo Wy, Lagos, Nigeria\"\ndest_y, dest_x = ox.geocode(dest_address) \n\n\n# Transformer: lon/lat ‚Üí graph CRS\ntransformer = Transformer.from_crs(\n    \"EPSG:4326\",\n    Gs.graph[\"crs\"],\n    always_xy=True\n)\n\n# Print coordinates\nprint(\"Origin coords:\", orig_x, orig_y)\nprint(\"Destination coords:\", dest_x, dest_y)\n\norig_x_p, orig_y_p = transformer.transform(orig_x, orig_y)\ndest_x_p, dest_y_p = transformer.transform(dest_x, dest_y)\n\n# Snap to graph\norig_node_id, dist_to_orig = ox.distance.nearest_nodes(\n    Gs, X=orig_x_p, Y=orig_y_p, return_dist=True\n)\ndest_node_id, dist_to_dest = ox.distance.nearest_nodes(\n    Gs, X=dest_x_p, Y=dest_y_p, return_dist=True\n)\n\n# Print distance to nearest node\nprint(\"Origin node-id:\", orig_node_id, \"and distance:\", dist_to_orig, \"meters.\")\nprint(\"Destination node-id:\", dest_node_id, \"and distance:\", dist_to_dest, \"meters.\")\n\n\n\n\n# Calculate shortest path between origin and destionation nodes and the length\npath = nx.shortest_path(Gs, source=orig_node_id, target=dest_node_id, weight='travel_time_mins')\nlength = nx.shortest_path_length(Gs, source=orig_node_id, target=dest_node_id, weight='travel_time_mins')\n\n\n\n\n\nlength\n\n\n# Shortest path based on distance\nfig, ax = ox.plot_graph_route(Gs, path)\n\n# Add the travel time as title\nax.set_xlabel(\"Shortest path is {t: .1f} minutes.\".format(t=length))\n\n\n# Explore graph edges and route together in a single map\nroute_edges = ox.routing.route_to_gdf(Gs, path, weight='length')\n\nm = edges.explore(color=\"black\", tiles=\"cartodbdarkmatter\")\nm = route_edges.explore(m=m, color=\"maroon\", style_kwds={\"weight\": 5})\n\n# Add the Esri World Imagery tile layer\nfolium.TileLayer(\n    tiles='https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n    attr='Esri',\n    name='Esri Satellite',\n    overlay=False,\n    control=True\n).add_to(m)\n\n# Add a layer control to toggle between tile layers\nfolium.LayerControl().add_to(m)\nm\n\n\n# Read in Nigeria health facilities layer\nlayer_url = \"https://services3.arcgis.com/BU6Aadhn6tbBEdyk/arcgis/rest/services/GRID3_NGA_health_facilities_v2_0/FeatureServer/0/query\"\n \n\n# Create bounding box\nquery_extent = {\n    \"xmin\": 3.328171,\n    \"ymin\": 6.582383,\n    \"xmax\": 3.383102,\n    \"ymax\": 6.633909}\n\n\n\nhealth_fac = fetch_nga_roads(query_extent, crs=\"EPSG:4326\", record_limit=200000, url=layer_url)\n\n \n\nhealth_fac.head(5)\n\n\n# Read in Nigeria schools layer\nlayer_url = \"https://services3.arcgis.com/BU6Aadhn6tbBEdyk/arcgis/rest/services/Schools_in_Nigeria/FeatureServer/0/query\"\n# feature_layer = FeatureLayer(layer_url)\n\n# Create bounding box\nquery_extent = {\n    \"xmin\": 3.328171,\n    \"ymin\": 6.582383,\n    \"xmax\": 3.383102,\n    \"ymax\": 6.633909,\n     \n}\n \nschools = fetch_nga_roads(query_extent, crs=\"EPSG:4326\", record_limit=200000, url=layer_url)\n\nschools.head(5)\n\n\n#set same crs as graph\nschools = schools.to_crs(Gs.graph[\"crs\"])\nhealth_fac = health_fac.to_crs(Gs.graph[\"crs\"])\n\nschools[\"longitude\"] = schools.geometry.x\nschools[\"latitude\"] = schools.geometry.y\n\nhealth_fac[\"longitude\"] = health_fac.geometry.x\nhealth_fac[\"latitude\"] = health_fac.geometry.y\n\n\n# Caclulate shortest route between every school and health facility using the travel_time_mins variable as the weight\n# this can take a few minutes\n\nweight_attribute = 'travel_time_mins'\n\n# Find nearest nodes to each school and health facility\norig_node_id, dist_to_orig = ox.distance.nearest_nodes(\n    Gs, \n    X=schools.geometry.x, Y=schools.geometry.y, return_dist=True)\ndest_node_id, dist_to_dest = ox.distance.nearest_nodes(Gs, X=health_fac.geometry.x, Y=health_fac.geometry.y, return_dist=True)\n\nshortest_paths = {}\n\nfor source in orig_node_id:\n    for target in dest_node_id:\n        try:\n            # Get the actual path\n            path = nx.shortest_path(Gs, source=source, target=target, weight=weight_attribute)\n            # Get the path length\n            length = nx.shortest_path_length(Gs, source=source, target=target, weight=weight_attribute)\n            shortest_paths[(source, target)] = {'path': path, 'length': length}\n        except nx.NetworkXNoPath:\n          # build dictionary with shortest routes\n            shortest_paths[(source, target)] = {'path': None, 'length': float('inf')}\n\nprint(shortest_paths)\n\nprint(\"Unique school nodes:\", len(set(orig_node_id)))\nprint(\"Unique facility nodes:\", len(set(dest_node_id)))\nprint(\"Snap distances (schools):\", dist_to_orig.min(), dist_to_orig.max())\nprint(\"Snap distances (facilities):\", dist_to_dest.min(), dist_to_dest.max())\n\n\n\n# create dataframe of shortest paths between every school and health facility and drop school/health facility combinations that aren't the closest\nimport pandas as pd\n# build dataframe\ndf = pd.DataFrame(shortest_paths).T\ndf = df.reset_index()\ndf = df.rename(columns={'level_0': 'school_node', 'level_1': 'health_facility_node'})\ndf = df.replace([np.inf, -np.inf], np.nan)\n\n# sort by length and keep only the shortest routes for each school\ndf = df.sort_values(by=['school_node', 'length'], ascending=[True, True])\ndf = df.drop_duplicates(subset=['school_node'], keep='first')\ndf\n\n\n# merge nearest node ID back to schools and health facitility geodataframes\n\n# set node ids\nschools['node_id'] = orig_node_id\nhealth_fac['node_id'] = dest_node_id\n\n# get only columns needed for merge\nschool_merge = schools[['node_id', 'name','latitude','longitude']]\nhealth_merge = health_fac[['node_id', 'facility_name']]\n\n# merge nearest routes with school and health facility information\nnearest_df = df.merge(school_merge, left_on='school_node', right_on='node_id')\nnearest_df = nearest_df.merge(health_merge, left_on='health_facility_node', right_on='node_id')\n\n# drop duplicates\nnearest_df1 = nearest_df.drop_duplicates(subset=['school_node', 'length'])\nnearest_df1\n\n\n# visualize all nearest routes\nimport random\nimport matplotlib.colors as mcolors\n# drop routes with nans\nnearest_df1 = nearest_df1.dropna(subset=['path'])\n\n# convert to list\nroutes = nearest_df1['path'].tolist()\n\n# set route colors\nnum_paths = len(routes)\ncolor_pool = list(mcolors.CSS4_COLORS.values()) # 148+ colors\npath_colors = random.choices(color_pool, k=num_paths)\n\n# plot map\n\ntransformer = Transformer.from_crs(\"EPSG:4326\", \"EPSG:3857\", always_xy=True)\n\nxmin, ymin = transformer.transform(3.328171, 6.582383)\nxmax, ymax = transformer.transform(3.383102, 6.633909)\n\nbbox_3857 = (xmin, ymin, xmax, ymax)\n    \nfig, ax = ox.plot_graph_routes(Gs, routes,route_colors=path_colors, route_linewidth=6, node_size=0, bbox=bbox_3857)\n\nplt.show()\n\n\n# Explore a route interactively\n\n# select school to view\nnearest_df1_s = nearest_df1[nearest_df1['name'] == 'Saint Joseph Secondary School']\n\nroute_edges = ox.routing.route_to_gdf(Gs, nearest_df1_s.iloc[0].path, weight='length')\n\n# map facilities, roads, and routes\nm = edges.explore(color=\"black\", tiles=\"cartodbdarkmatter\")\nm = route_edges.explore(m=m, color=\"yellow\", style_kwds={\"weight\": 5})\nm = schools.explore(m=m, color = \"blue\", style_kwds={\"weight\": 5})\nm = health_fac.explore(m=m, color = \"red\", style_kwds={\"weight\": 5})\n# add the Esri World Imagery tile layer to interactive map\nfolium.TileLayer(\n    tiles='https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n    attr='Esri',\n    name='Esri Satellite',\n    overlay=False,\n    control=True\n).add_to(m)\n\n# add a layer control to toggle between tile layers\nfolium.LayerControl().add_to(m)\nm\n\n\n# Map the travel time from each school to the nearset health facility - darker dots are closer to a health facility, red dots are health facilities\n\n# construct geodataframe\ngeometry = gpd.points_from_xy(nearest_df1['longitude'], nearest_df1['latitude'])\nnearest_gdf = gpd.GeoDataFrame(nearest_df1, geometry=geometry, crs='EPSG:4326')\n\nedges_plot = edges.to_crs(epsg=4326)\nhealth_plot = health_fac.to_crs(epsg=4326)\n\n\n# Plot with length column for travel time\nfig, ax = plt.subplots(1, 1, figsize=(5, 5))\nedges.plot(ax=ax, color='grey', alpha=.1, zorder=1)\nhealth_fac.plot(marker='+', color='red', legend=True, ax=ax, markersize=5, zorder=3)\nnearest_gdf.plot(column='length', cmap='inferno', legend=True, ax=ax, markersize=25, zorder=2)\nplt.title(\"Time from school to nearest health facility\")\nax.set_xlim(bbox_3857[0], bbox_3857[2])\nax.set_ylim(bbox_3857[1], bbox_3857[3]  )\nplt.show()",
    "crumbs": [
      "Home",
      "Visualization",
      "Finding routes between schools and health facilities"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "GRID3 Data Science User Guide",
    "section": "",
    "text": "GRID3 Logo",
    "crumbs": [
      "Home",
      "Getting Started",
      "GRID3 Data Science User Guide"
    ]
  },
  {
    "objectID": "index.html#video-overview",
    "href": "index.html#video-overview",
    "title": "GRID3 Data Science User Guide",
    "section": "2.1 Video Overview",
    "text": "2.1 Video Overview",
    "crumbs": [
      "Home",
      "Getting Started",
      "GRID3 Data Science User Guide"
    ]
  },
  {
    "objectID": "index.html#getting-started",
    "href": "index.html#getting-started",
    "title": "GRID3 Data Science User Guide",
    "section": "2.2 üöÄ Getting started",
    "text": "2.2 üöÄ Getting started\nIf you‚Äôre new, start here:\nüëâ Jupyter Notebook User Guide: Querying and Mapping Data\nThis notebook walks through: - Querying a GRID3 Feature Service - Converting responses to GeoDataFrames - Visualizing results with Folium\n\n\n\n\n2.2.1 üì° Data Access\nQuery Feature Services, download datasets, and work with APIs.\nGet started ‚Üí\n\n\n2.2.2 üìö User Guide Template\nA template for creating GRID3 data user guides.\nView the template ‚Üí\n\n\n\n2.2.3 üìä Analysis\nCommon patterns for spatial and tabular analysis.\nAPI Nigeria Road Network Analysis\n\n\n2.2.4 üó∫Ô∏è Visualization\nCreate interactive and static maps with Folium and GeoPandas.\nView mapping guides ‚Üí",
    "crumbs": [
      "Home",
      "Getting Started",
      "GRID3 Data Science User Guide"
    ]
  },
  {
    "objectID": "notebooks/nb1.html",
    "href": "notebooks/nb1.html",
    "title": "This is a userguide test notebook",
    "section": "",
    "text": "image 1\n\n\nAbove is an image by Monet\n\nimport os\nimport pandas as pd\nfrom arcgis.gis import GIS\nimport requests\nimport geopandas as gpd\nimport folium\n\nUse the GRID3 data portal to find data you would like to use: https://data.grid3.org/\nOr see a list of GRID3 REST services available: https://services3.arcgis.com/BU6Aadhn6tbBEdyk/arcgis/rest/services\n\n\nurl = \"https://services3.arcgis.com/BU6Aadhn6tbBEdyk/arcgis/rest/services/GRID3_NGA_roads/FeatureServer/0/query\"\n \nparams = {\n        \"where\": \"1=1\",\n        \"outFields\": \"*\",\n        \"outSR\": 4326,\n        \"f\": \"json\" \n    }\n\nresp = requests.get(url, params=params)\ndata = resp.json()\ndata.keys()\n\ndict_keys(['objectIdFieldName', 'uniqueIdField', 'globalIdFieldName', 'geometryProperties', 'geometryType', 'spatialReference', 'fields', 'exceededTransferLimit', 'features'])\n\n\n\n\nfeatures = data[\"features\"] #use features as the key to get list of features from this dataset\n\n# attributes\ndf = pd.json_normalize([f[\"attributes\"] for f in features])\n\ngeoms = []\n\nfrom shapely.geometry import LineString\n\nfor f in features:\n    geom = f[\"geometry\"]\n\n    if \"paths\" in geom:\n        # most road features have one path\n        geoms.append(LineString(geom[\"paths\"][0]))\n    else:\n        geoms.append(None)\n        \n        \ngdf = gpd.GeoDataFrame(\n    df,\n    geometry=geoms,\n    crs=\"EPSG:4326\"\n)\n\ngdf.head()\n \n\n\n\n\n\n\n\n\nOBJECTID\nid\ncountry\niso3\nsource_id\nclass\nspeed_estimate\nspeed_estimate_method\nroad_surface\nnames\nsubclass\nspeed_limits\ndate\nsource_acronym\nShape__Length\ngeometry\n\n\n\n\n0\n1\n08059fffffffffff046f5212a07291c3\nNigeria\nNGA\nOverture / OSM\nunclassified\n40\nliterature review\n\n\nNone\n\\r\n2025\nOVERTURE_OSM_001\n5509.471374\nLINESTRING (6.75328 9.90715, 6.75328 9.90717, ...\n\n\n1\n2\n08059fffffffffff046ff6a34145d397\nNigeria\nNGA\nOverture / OSM\nunclassified\n40\nliterature review\n\n\n\n\n2025\nOVERTURE_OSM_001\n2944.939957\nLINESTRING (6.78229 9.88151, 6.78231 9.88163, ...\n\n\n2\n3\n08059fffffffffff046ff6d48288b3ef\nNigeria\nNGA\nOverture / OSM\nunclassified\n40\nliterature review\n\n\n\n\n2025\nOVERTURE_OSM_001\n3355.942042\nLINESTRING (6.80792 9.88413, 6.80758 9.8839, 6...\n\n\n3\n4\n08059fffffffffff046ff775b238a897\nNigeria\nNGA\nOverture / OSM\nunclassified\n40\nliterature review\n\n\n\n\n2025\nOVERTURE_OSM_001\n3808.948460\nLINESTRING (6.81537 9.84995, 6.81475 9.84981, ...\n\n\n4\n5\n08059fffffffffff046fff05b325608b\nNigeria\nNGA\nOverture / OSM\ntertiary\n50\nGPS\n\n\n\n\n2025\nOVERTURE_OSM_001\n7136.589369\nLINESTRING (6.75366 9.82817, 6.75391 9.82827, ...\n\n\n\n\n\n\n\n\ngdf.plot()",
    "crumbs": [
      "Home",
      "Data Access",
      "This is a userguide test notebook"
    ]
  },
  {
    "objectID": "notebooks/nb1.html#data-access",
    "href": "notebooks/nb1.html#data-access",
    "title": "This is a userguide test notebook",
    "section": "",
    "text": "image 1\n\n\nAbove is an image by Monet\n\nimport os\nimport pandas as pd\nfrom arcgis.gis import GIS\nimport requests\nimport geopandas as gpd\nimport folium\n\nUse the GRID3 data portal to find data you would like to use: https://data.grid3.org/\nOr see a list of GRID3 REST services available: https://services3.arcgis.com/BU6Aadhn6tbBEdyk/arcgis/rest/services\n\n\nurl = \"https://services3.arcgis.com/BU6Aadhn6tbBEdyk/arcgis/rest/services/GRID3_NGA_roads/FeatureServer/0/query\"\n \nparams = {\n        \"where\": \"1=1\",\n        \"outFields\": \"*\",\n        \"outSR\": 4326,\n        \"f\": \"json\" \n    }\n\nresp = requests.get(url, params=params)\ndata = resp.json()\ndata.keys()\n\ndict_keys(['objectIdFieldName', 'uniqueIdField', 'globalIdFieldName', 'geometryProperties', 'geometryType', 'spatialReference', 'fields', 'exceededTransferLimit', 'features'])\n\n\n\n\nfeatures = data[\"features\"] #use features as the key to get list of features from this dataset\n\n# attributes\ndf = pd.json_normalize([f[\"attributes\"] for f in features])\n\ngeoms = []\n\nfrom shapely.geometry import LineString\n\nfor f in features:\n    geom = f[\"geometry\"]\n\n    if \"paths\" in geom:\n        # most road features have one path\n        geoms.append(LineString(geom[\"paths\"][0]))\n    else:\n        geoms.append(None)\n        \n        \ngdf = gpd.GeoDataFrame(\n    df,\n    geometry=geoms,\n    crs=\"EPSG:4326\"\n)\n\ngdf.head()\n \n\n\n\n\n\n\n\n\nOBJECTID\nid\ncountry\niso3\nsource_id\nclass\nspeed_estimate\nspeed_estimate_method\nroad_surface\nnames\nsubclass\nspeed_limits\ndate\nsource_acronym\nShape__Length\ngeometry\n\n\n\n\n0\n1\n08059fffffffffff046f5212a07291c3\nNigeria\nNGA\nOverture / OSM\nunclassified\n40\nliterature review\n\n\nNone\n\\r\n2025\nOVERTURE_OSM_001\n5509.471374\nLINESTRING (6.75328 9.90715, 6.75328 9.90717, ...\n\n\n1\n2\n08059fffffffffff046ff6a34145d397\nNigeria\nNGA\nOverture / OSM\nunclassified\n40\nliterature review\n\n\n\n\n2025\nOVERTURE_OSM_001\n2944.939957\nLINESTRING (6.78229 9.88151, 6.78231 9.88163, ...\n\n\n2\n3\n08059fffffffffff046ff6d48288b3ef\nNigeria\nNGA\nOverture / OSM\nunclassified\n40\nliterature review\n\n\n\n\n2025\nOVERTURE_OSM_001\n3355.942042\nLINESTRING (6.80792 9.88413, 6.80758 9.8839, 6...\n\n\n3\n4\n08059fffffffffff046ff775b238a897\nNigeria\nNGA\nOverture / OSM\nunclassified\n40\nliterature review\n\n\n\n\n2025\nOVERTURE_OSM_001\n3808.948460\nLINESTRING (6.81537 9.84995, 6.81475 9.84981, ...\n\n\n4\n5\n08059fffffffffff046fff05b325608b\nNigeria\nNGA\nOverture / OSM\ntertiary\n50\nGPS\n\n\n\n\n2025\nOVERTURE_OSM_001\n7136.589369\nLINESTRING (6.75366 9.82817, 6.75391 9.82827, ...\n\n\n\n\n\n\n\n\ngdf.plot()",
    "crumbs": [
      "Home",
      "Data Access",
      "This is a userguide test notebook"
    ]
  },
  {
    "objectID": "notebooks/nb1.html#using-folium-to-visualize-data",
    "href": "notebooks/nb1.html#using-folium-to-visualize-data",
    "title": "This is a userguide test notebook",
    "section": "2 Using Folium to visualize data",
    "text": "2 Using Folium to visualize data\nThe package folium is a great way to visualize spatial data in Python. Below is an example of how to use it.\n\n\n\n# center the map on your data\nminx, miny, maxx, maxy = gdf.total_bounds\n\ncenter = [\n    (miny + maxy) / 2,\n    (minx + maxx) / 2\n]\n\nm = folium.Map(\n    location=center,\n    zoom_start=8,\n    tiles=\"CartoDB positron\" #\"OpenStreetMap\"  # basemap\n)\n\nfolium.GeoJson(\n    gdf,\n    name=\"GRID3 Roads\",\n    popup=folium.GeoJsonPopup(\n        fields=list(df.columns)[:5]  # limit fields\n    )\n).add_to(m)\n\n\n\nfolium.LayerControl().add_to(m)\n\nm\n\nMake this Notebook Trusted to load map: File -&gt; Trust Notebook",
    "crumbs": [
      "Home",
      "Data Access",
      "This is a userguide test notebook"
    ]
  }
]